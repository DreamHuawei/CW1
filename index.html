<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/vue@2"></script>
    <link rel="stylesheet" type="text/css" href="css/css.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <title>Document</title>
    
</head>
 
<body>
    <div id="app">
    <header>
        <div id="navbarChange" class="navbar navbar-default" style="background-color:blanchedalmond;">
          <div class="navbar-nav">
            <h1>Happy Store</h1>
          </div>
          <div class="nav navbar-nav navbar-right cart" style="padding-right: 70px;" >
            <button id="btn1" type="button" class="btn btn-default" v-on:click="showCheckout">
              <span class="glyphicon glyphicon-shopping-cart">{{ cartItemCount}}</span> Checkout
            </button>
            <div class="searchBox" style="margin-top: 10px;">
                <form action="/search" method="get">
                    <input type="search"  placeholder="Search">
                    <input type="submit" class="btn btn-default" value="Search">
                </form>
            </div>
              
          </div>
        </div>
    </header>
    <main>
        <div class="row product">
          <div v-if="showProduct">
            
            <div class="col-md-2 col-md-offset-1">
              <figure>
                <img :src="product.image">
              </figure>
            </div> <!--管理产品的图像-->

            <div class="col-md-6 col-md-offset-2 description">
              <h1 v-text="product.title"></h1>
              <p v-html="product.description"></p>
              <p class="price">
              <strong>{{product.price | formatPrice}}</strong>
              </p>
              <button class=" btn btn-primary btn-lg" 
                      v-on:click="addToCart" 
                      v-if="canAddToCart">
                      Add to cart
              </button>
              <button disabled="true" 
                      class=" btn btn-primary btn-lg" 
                      v-else >
                      Add to cart
              </button>
            </div>
          </div>
          <div v-else>
    
          </div>
        </div><!--end of row-->
    </main><!--end of main-->
    </div>

    <script type="text/javascript" >
        var APP_LOG_LIFECYCLE_EVENTS = true;
        var webstore = new Vue({
          el: '#app',
          data: {
            sitename: "Vue.js Pet Depot",
            showProduct: true,
            product: {
              id: 1001,
              title: "Cat Food, 25lb bag",
              description: "A 25 pound bag of <strong><em>irresistible</em></strong>, organic goodness for your cat.",
              price: 2000,
              image: "Images/cat.png",
              availableInventory: 5
            },
            cart: []
          },


          methods: {
            addToCart: function() {
              this.cart.push( this.product.id );
            },
            showCheckout() {
                this.showProduct = this.showProduct ? false: true;
            },
          },

          //计算商品被添加进购物车的数量
          //计算商品可以被加入购物车的数量
          computed: {
              cartItemCount() {
                return this.cart.length || '';
              },
              canAddToCart() {
                return this.product.availableInventory > this.cartItemCount;
              }
          },

          //价格计算规则开始
          filters: {
            formatPrice(price) {	
              if (!parseInt(price)) { return ""; }	
              if (price > 99999) {	
                var priceString = (price / 100).toFixed(2);	
                var priceArray = priceString.split("").reverse();	
                var index = 3;	
                while (priceArray.length > index + 3) {	
                  priceArray.splice(index+3, 0, ",");	
                  index += 4;	
                }	
                return "$" + priceArray.reverse().join("");	
              }
              else {
                return "$" + (price / 100).toFixed(2);
              }
            }
          },
          //价格计算规则结束

          //记录和控制app生命周期改变前后的事件
          beforeCreate: function() {	
            if (APP_LOG_LIFECYCLE_EVENTS) {	
              console.log("beforeCreate");	
            }
          },	
          created: function() {	
            if (APP_LOG_LIFECYCLE_EVENTS) {	
              console.log("created");	
            }	
          },	
          beforeMount: function() {	
            if (APP_LOG_LIFECYCLE_EVENTS) {	
              console.log(" beforeMount");	
            }	
          },	
          mounted:  function() {	
            if (APP_LOG_LIFECYCLE_EVENTS) {	
              console.log(" mounted"); 	
            } 	
          },	
          beforeUpdate:  function() { 	
            if (APP_LOG_LIFECYCLE_EVENTS) { 	
              console.log("beforeUpdate"); 	
            } 	
          },	
          updated:  function() { 	
            if (APP_LOG_LIFECYCLE_EVENTS) { 	
              console.log("updated"); 	
            } 	
          },	
          beforeDestroyed:  function() { 	
            if (APP_LOG_LIFECYCLE_EVENTS) { 	
              console.log("beforeDestroyed "); 	
            } 	
          },	
          destroyed:  function() { 	
            if (APP_LOG_LIFECYCLE_EVENTS) { 	
              console.log("destroyed"); 	
            } 	
          }
        });

 </script>    
</body>

</html>